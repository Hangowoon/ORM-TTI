<!-- Top -->
<style>

</style>
<!-- Navigation-->
<nav class="navbar navbar-expand-lg navbar-light fixed-top py-3" id="mainNav">
	<div class="container px-4 px-lg-5">
		<a class="navbar-brand" href="/main">TTI</a>

		<button
			class="navbar-toggler navbar-toggler-right"
			type="button"
			data-bs-toggle="collapse"
			data-bs-target="#navbarResponsive"
			aria-controls="navbarResponsive"
			aria-expanded="false"
			aria-label="Toggle navigation"
		>
			<span class="navbar-toggler-icon"></span>
		</button>

		<div class="collapse navbar-collapse" id="navbarResponsive">
			<ul class="navbar-nav ms-auto my-2 my-lg-0">
				<li class="nav-item">
					<a class="nav-link" href="/create">Create</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="/gallery">Gallery</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="/my">My Page</a>
				</li>
				<li class="nav-item">
					<a class="nav-link" href="/logout">Log Out</a>
				</li>
			</ul>
		</div>
	</div>
</nav>

<!-- center -->



<!-- Masthead-->
<header class="masthead">
	<!-- 설명란 -->
	<div class="container px-4 px-lg-5 h-25">
		<div class="row gx-4 gx-lg-5 align-items-center justify-content-center text-center">
			<div class="col-lg-8 align-self-end mt-3">
				<h2 class="text-white font-weight-bold">작품을 감상하세요.</h2>
				<p class="text-white-75 mb-5">다른 사람들의 작품을 감상하고, 나만의 작품을 다른 사람들과 함께 공유하세요.</p>
			</div>
		</div>
	</div>
    <!-- Pagination -->
<nav aria-label="Image Pagination">

    <ul class="pagination justify-content-center mt-2">
        <!-- prettier-ignore -->
        <% let pageLimit = 5; %> 
        <% let totalPageNumbers = (pageLimit > totalImages) ? totalImages : pageLimit; %>
        <% let maxLeft = (currentPage - Math.floor(totalPageNumbers / 2)); %>
        <% let maxRight = (currentPage + Math.floor(totalPageNumbers / 2)); %>

        <% if(maxLeft < 1) { %>
            <% maxLeft = 1; %>
            <% maxRight = totalPageNumbers; %>
        <% } %>

        <% if(maxRight > totalImages) { %>
            <% maxLeft = totalImages - (totalPageNumbers - 1); %>
            <% maxRight = totalImages; %>

            <% if(maxLeft < 1) maxLeft = 1; %>
        <% } %>

        <!-- 처음 페이지로 가는 링크 -->
        <% if(currentPage != 1) { %>
            <li class="page-item">
                <a class="page-link" href="/gallery?page=1">처음</a>
            </li>
        <% } %>

        <!-- 이전 페이지로 가는 링크 -->
        <% if(currentPage > 1) { %>
            <li class="page-item">
                <a class="page-link" href="/gallery?page=<%= currentPage - 1 %>">&laquo;</a>
            </li>
        <% } %>

        <% for(let i = maxLeft; i <= maxRight; i++) { %>
            <li class="page-item <%= currentPage === i ? 'active' : '' %>">
                <a class="page-link" href="/gallery?page=<%= i %>"><%= i %></a>
            </li>
        <% } %>

        <!-- 다음 페이지로 가는 링크 -->
        <% if(currentPage < totalImages) { %>
            <li class="page-item">
                <a class="page-link" href="/gallery?page=<%= currentPage + 1 %>">&raquo;</a>
            </li>
        <% } %>

        <!-- 마지막 페이지로 가는 링크 -->
        <% if(currentPage != totalImages) { %>
            <li class="page-item">
                <a class="page-link" href="/gallery?page=<%= totalImages %>">마지막</a>
            </li>
        <% } %>
    </ul>
</nav>

	<!-- 갤러리 목록 -->
	<div id="portfolio" >
		<div class="container-fluid p-0 h-30 ">
			<div class="row g-0">
				<div class="row g-0 col-lg-12">
					<% closuerUserImage.forEach(function(image,index){ %>
					<!-- 작품1 -->
					<div class="col-lg-3 col-sm-6">
						<div class="portfolio-box" data-bs-toggle="modal" data-bs-target="#portfolioModal<%= index %>">
							<img class="img-fluid" src="<%= image.data_save_path %>" alt="<%= image.data_prompt %>" />
							<div class="portfolio-box-caption">
								<div class="project-category text-white-50"><%= image.data_ai_model_name %></div>
								<div class="project-name"><%= image.data_prompt %></div>
							</div>
						</div>
					</div>

					<% }); %>

					<!-- 작품2 -->
					<!-- <div class="col-lg-3 col-sm-6">
						<a
							class="portfolio-box"
							href="assets/img/portfolio/fullsize/img_02.JPG"
							title="장엄한 왕관을 쓰고 왕좌에 앉아 감자 신하들과 감자 성들로 가득 찬 광대한 감자 왕국을 감독하는 자근 감자왕들."
						>
							<img class="img-fluid" src="assets/img/portfolio/thumbnails/img_02.JPG" alt="img-002" />
							<div class="portfolio-box-caption">
								<div class="project-category text-white-50">Category</div>
								<div class="project-name">장엄한 왕관을 쓰고 왕좌에 앉아 감자 신하들과 감자 성들</div>
							</div>
						</a>
					</div> -->
				</div>
			</div>
		</div>
	</div>

	<!-- 하단 이미지 목록 페이지  -->
	<!-- <div class="text-white text-center mt-4 mb-4">1 2 3</div>-->
</header>

<!-- Pagination -->


<!-- 이미지 모달창 -->
<!-- Portfolio Modal 1-->

<% closuerUserImage.forEach(function(image,index){ %>
<div class="portfolio-modal modal fade" id="portfolioModal<%=index%>" tabindex="-1" aria-labelledby="portfolioModal<%=index%>" aria-hidden="true">
	<div class="modal-dialog modal-xl">
		<div class="modal-content">
			<div class="modal-header border-0">
				<button class="btn-close" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body text-center pb-5">
				<div class="container">
					<div class="row justify-content-center">
						<div class="col-lg-11">
							<!-- Portfolio Modal - Title-->
							<!-- Icon Divider-->
							<div class="divider-custom">
								<div class="divider-custom-line"></div>
								<div class="divider-custom-icon">
									<i class="fas fa-star"></i>
								</div>
								<div class="divider-custom-line"></div>
							</div>
							<!-- Portfolio Modal - Image-->
							<img class="img-fluid rounded mb-3" src="<%= image.data_save_path %>" alt="<%= image.data_prompt %>" />
							<!-- Portfolio Modal - Text-->
							<div class="form-floating mb-1">
								<p class="text-black"><%= image.data_prompt %></p>
								<p class="text-black"><%= image.reg_date %> ㅣ <%= image.data_ai_model_name %> ㅣ <%= image.data_img_size %></p>
							</div>
							<a href="<%= image.data_save_path %>" download class="btn btn-secondary"> <i class="fas fa-download fa-fw"></i> 다운로드 </a>
							<button class="btn btn-primary" data-bs-dismiss="modal" onclick="handleShare('<%= image.data_save_path %>')">
								<i class="fas fa-share fa-fw"></i>
								공유하기
							</button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<% }); %>

<!-- Modal -->
<div class="modal fade" id="feedbackModal" tabindex="-1" aria-labelledby="feedbackModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header bg-gradient-primary-to-secondary p-4">
				<h5 class="modal-title font-alt text-white" id="feedbackModalLabel">Send feedback</h5>
				<button class="btn-close btn-close-white" type="button" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<div class="modal-body border-0 p-4">
				<!-- * * * * * * * * * * * * * * *-->
				<!-- * * SB Forms Contact Form * *-->
				<!-- * * * * * * * * * * * * * * *-->
				<!-- This form is pre-integrated with SB Forms.-->
				<!-- To make this form functional, sign up at-->
				<!-- https://startbootstrap.com/solution/contact-forms-->
				<!-- to get an API token!-->
				<form id="contactForm" data-sb-form-api-token="API_TOKEN">
					<!-- Name input-->
					<div class="form-floating mb-3">
						<input class="form-control" id="name" type="text" placeholder="Enter your name..." data-sb-validations="required" />
						<label for="name">Full name</label>
						<div class="invalid-feedback" data-sb-feedback="name:required">A name is required.</div>
					</div>
					<!-- Email address input-->
					<div class="form-floating mb-3">
						<input class="form-control" id="email" type="email" placeholder="name@example.com" data-sb-validations="required,email" />
						<label for="email">Email address</label>
						<div class="invalid-feedback" data-sb-feedback="email:required">An email is required.</div>
						<div class="invalid-feedback" data-sb-feedback="email:email">Email is not valid.</div>
					</div>
					<!-- Phone number input-->
					<div class="form-floating mb-3">
						<input class="form-control" id="phone" type="tel" placeholder="(123) 456-7890" data-sb-validations="required" />
						<label for="phone">Phone number</label>
						<div class="invalid-feedback" data-sb-feedback="phone:required">A phone number is required.</div>
					</div>
					<!-- Message input-->
					<div class="form-floating mb-3">
						<textarea class="form-control" id="message" type="text" placeholder="Enter your message here..." style="height: 10rem" data-sb-validations="required"></textarea>
						<label for="message">Message</label>
						<div class="invalid-feedback" data-sb-feedback="message:required">A message is required.</div>
					</div>
					<!-- Submit success message-->
					<!---->
					<!-- This is what your users will see when the form-->
					<!-- has successfully submitted-->
					<div class="d-none" id="submitSuccessMessage">
						<div class="text-center mb-3">
							<div class="fw-bolder">Form submission successful!</div>
							To activate this form, sign up at
							<br />
							<a href="https://startbootstrap.com/solution/contact-forms">https://startbootstrap.com/solution/contact-forms</a>
						</div>
					</div>
					<!-- Submit error message-->
					<!---->
					<!-- This is what your users will see when there is-->
					<!-- an error submitting the form-->
					<div class="d-none" id="submitErrorMessage">
						<div class="text-center text-danger mb-3">Error sending message!</div>
					</div>
					<!-- Submit Button-->
					<div class="d-grid">
						<button class="btn btn-primary rounded-pill btn-lg disabled" id="submitButton" type="submit">Submit</button>
					</div>
				</form>
			</div>
		</div>
	</div>
</div>

<title><%=title %></title>

<script>
	function handleShare(imageUrl) {
		//현재 도메인 가져오기
		const domain = window.location.origin;
		//도메인과 이미지 경로를 결합
		const fullImageUrl = `${domain}${imageUrl}`;

		navigator.clipboard
			.writeText(fullImageUrl)
			.then(() => {
				alert("이미지 URL이 클립보드에 복사되었습니다!");
			})
			.catch((err) => {
				console.error("클립보드 복사 실패:", err);
			});
	}
</script>
